# VERSION FINALISEE AU 202401
## En cours de création

# Analyse statistique des indicateurs PE et qualités d'eau ----

## Library ----
#library(MASS)
library(tidyverse)
library(stats)


## Chargement des données ----

load(file = "data_processed/w_pe_stat_1.RData")

## Test de correlation ----

correlations_toutes_variables_synth <- 
  chart.Correlation(stat_corr_me_ipr %>% 
                      select(surface_me,
                             surface_me,
                             surface_moy_pe_perm,
                             densite_pehm_sur_cours,
                             densite_pehm_connecte,
                             prct_surf_pehm_tdbv,
                             prct_synth, 
                             densite_synth,
                             intercept_synth,
                             densite_zhp_zhp_synth,
                             prct_surf_zhp_zhp_synth,
                             ipr_etat),
                    histogram = TRUE,
                    pch = 19)

## modélisation de l'IPR en fonction des variables pressions plans d'eau ---
names(stat_corr_me_ipr)

stat_corr_me_ipr <- stat_corr_me_ipr %>% 
  column_to_rownames("cdeumassed")

mod1 <- lm(ipr_etat ~
            # surface_me +
             surface_moy_pe_perm +
             densite_pehm_sur_cours +
             densite_pehm_connecte +
             prct_surf_pehm_tdbv +
             prct_synth +
             densite_synth +
             intercept_synth +
             densite_zhp_zhp_synth +
             prct_surf_zhp_zhp_synth
             ,
  data = stat_corr_me_ipr)

summary(mod1)

plot(mod1)

cook <- cooks.distance(mod1)

test <- as.data.frame(cook) %>% 
  rownames_to_column("cdeumassed")

mod2 <- MASS::stepAIC(mod1)

summary(mod2)
  



